<HTML><HEAD><TITLE>SQL Scripts</TITLE>
<META Name="description" 
Content="We provide a Library of free SQL Scripts.">
<META Name="keywords" Content="SQL SCripts">
</HEAD>

<BODY TEXT="#202020"><script>#</script>

<HTML><HEAD><TITLE>Careers Page</TITLE></HEAD> 

<BODY TEXT="#202020">

<TABLE WIDTH=100%>
<TR>
<TD ALIGN=left VALIGN=middle>
<IMG ALT="Database Answers Header" HEIGHT=58 WIDTH=400 SRC="../images/dba_400_home.jpg">
</TD> 
<TD ALIGN=right HEIGHT=95 ROWSPAN=2 VALIGN=middle>
<IMG ALT="Rhuddlan Castle, North Wales" HEIGHT=85 WIDTH=266 SRC="../images/welsh_castle_sml.jpg">
</TD>
</TR>

<TR>
<TD ALIGN=left VALIGN=middle>
<IMG ALT="SQL Scripts" HEIGHT=19 WIDTH=120 SRC="../images/buttons/button_studio/sql_scripts_on.gif"> 
</TD> 
</TR>

</TABLE>

<TABLE BGCOLOR="#0000FF" WIDTH=100%>
<TR>
<TD ALIGN=left COLSPAN=1 VALIGN=TOP WIDTH=40>
<A HREF="../index.htm"><IMG ALT="Home" BORDER=0 SRC="../images/buttons/button_studio/home.gif"></A>
</TD>
<TD ALIGN=left VALIGN=top WIDTH=100>
<A HREF="../ask_a_question_rbw.php3">
<IMG ALT="Ask a Question" BORDER=0 SRC="../images/buttons/button_studio/ask_a_question.gif"></A>
</TD>
<TD ALIGN=left VALIGN=top WIDTH=85>
<A HREF="../data_models/index.htm">
<IMG ALT="Data Models" BORDER=0 SRC="../images/buttons/button_studio/data_models.gif"></A>
</TD><TD ALIGN=left VALIGN=top WIDTH=50>
<A HREF="../faqs.htm"><IMG ALT="FAQs" BORDER=0 SRC="../images/buttons/button_studio/faqs.gif"></A>
</TD>
<TD ALIGN=left VALIGN=top WIDTH=50>
<A HREF="../search.htm"><IMG ALT="Search" BORDER=0 SRC="../images/buttons/button_studio/search.gif"></A>
</TD><TD ALIGN=left VALIGN=top WIDTH=62>
<A HREF="../site_map.htm"><IMG ALT="Site Map" BORDER=0 SRC="../images/buttons/button_studio/site_map.gif"></A></TD>
<TD ALIGN=right VALIGN=top><FONT COLOR=white face="Verdana" size="1">&nbsp</TD>
</TR>

</TABLE>

<FONT COLOR=blue FACE=Verdana SIZE=2>
<!-- end Standard Header - Version 3-->

<!-- begin body Text -->

<TABLE BGCOLOR="#98CEFD" WIDTH=100%>
<TR>
<TD ALIGN=left VALIGN=top>
<IMG ALT="Chateau in Loire Valley" HEIGHT=150 WIDTH=92 SRC="../images/chateau_loire_sml.jpg"></A>
</TD>

<TD>
<FONT COLOR=blue FACE=Verdana SIZE=2>We have <A HREF="other_scripts.htm">another Page</A> of links to Scripts available from 
from other Web Sites,with some overlap, or you can Search for a particular Script ...
<!-- Atomz.com Search HTML for KPI Systems -->
<form method="get" action="http://search.atomz.com/search/">
<input size=15 name="sp-q">&nbsp;&nbsp<input type=submit value="Search">
<input type=hidden name="sp-a" value="00011467-sp00000000"></form>

<CENTER>
<TABLE BORDER=0 CELLPADDING=5 WIDTH=80%>
<TR>
<TD ALIGN=middle BGCOLOR="blue"><B><FONT COLOR=white>CATEGORY</TD>
<TD ALIGN=middle BGCOLOR="blue"><B><FONT COLOR=white>DESCRIPTION</TD>
</TR>

<TR>
<TD BGCOLOR="#003088"><FONT COLOR=white SIZE=2>Auto-Increment</TD>
<TD BGCOLOR="#003088" VALIGN=TOP>
<A HREF="ora_sequence.htm">
<FONT COLOR=white SIZE=2>Shows use of Oracle Sequence for auto-increment.</FONT></A>
</TD>
</TR>

<TR>
<TD BGCOLOR="#003088"><FONT COLOR=white SIZE=2>Date & Time</TD>
<TD BGCOLOR="#003088" VALIGN=TOP>

<A HREF="#CHECK_DATE"><FONT COLOR=white SIZE=2>Check Date and Time in SQL in Oracle Report Format.</FONT></A></TD>
</TR>

<TR>
<TD BGCOLOR="#003088"><FONT COLOR=white SIZE=2>Data Analysis</TD>
<TD BGCOLOR="#003088" VALIGN=TOP>
<A HREF="1chkonrs.htm"><FONT COLOR=white SIZE=2>1. Check Table Owners.</A>
</TD>
</TR>

<TR>
<TD BGCOLOR="#003088"><FONT COLOR=white SIZE=2>Data Analysis</TD>
<TD BGCOLOR="#003088" VALIGN=TOP>
<A HREF="2chkrows.htm"><FONT COLOR=white SIZE=2>2. Check Row Counts.</A>
</TD>
</TR>

<TR>
<TD BGCOLOR="#003088"><FONT COLOR=white SIZE=2>Data Analysis</TD>
<TD BGCOLOR="#003088" VALIGN=TOP>
<A HREF="3chkkeys.htm"><FONT COLOR=white SIZE=2>3. Check Primary Keys.</A>
</TD>
</TR>

<TR>
<TD BGCOLOR="#003088"><FONT COLOR=white SIZE=2>Data Analysis</TD>
<TD BGCOLOR="#003088" VALIGN=TOP>
<A HREF="tbl_defs.htm"><FONT COLOR=white SIZE=2>Print definitions of the Tables in the Database.</FONT></A>
</TD>
</TR>

<TR>
<TD BGCOLOR="#003088"><FONT COLOR=white SIZE=2>Data Analysis</TD>
<TD BGCOLOR="#003088" VALIGN=TOP>
<A HREF="tbl_defs.htm#TABLE_DEFS_OUTPUT"><FONT COLOR=white SIZE=2>Sample Output for Database Report.</A>
</TD>
</TR>

<TR>
<TD BGCOLOR="#003088"><FONT COLOR=white SIZE=2>Data Analysis</TD>
<TD BGCOLOR="#003088" VALIGN=TOP>
<A HREF="tbl_spcs.htm"><FONT COLOR=white SIZE=2>Check Table Spaces.</A>
</TD>
</TR>

<TR>
<TD BGCOLOR="#003088"><FONT COLOR=white SIZE=2>Data Analysis</TD>
<TD BGCOLOR="#003088" VALIGN=TOP>
<A HREF="#GEN_ANALYZE"><FONT COLOR=white SIZE=2>Generate SQL to Analyze Record Count Statistics.</A></FONT></TD>
</TR>

<TR>
<TD BGCOLOR="#003088"><FONT COLOR=white SIZE=2>Data Analysis</TD>
<TD BGCOLOR="#003088" VALIGN=TOP>
<A HREF="#GEN_CHECK"><FONT COLOR=white SIZE=2>Generate SQL to Check for specific data values.</A>
</TD>
</TR>

<TR>
<TD BGCOLOR="#003088"><FONT COLOR=white SIZE=2>Data Analysis</TD>
<TD BGCOLOR="#003088" VALIGN=TOP>
<A HREF="#WHERE_USED"><FONT COLOR=white SIZE=2>Where a specific Column is used in Tables.</A>
</TD>
</TR>

<TR>
<TD BGCOLOR="#003088"><FONT COLOR=white SIZE=2>Data Analysis</TD>
<TD BGCOLOR="#003088" VALIGN=TOP>
<A HREF="#GEN_DELETE"><FONT COLOR=white SIZE=2>Generate SQL to Delete data.</A>
</TD>
</TR>

<TR>
<TD BGCOLOR="#003088"><FONT COLOR=white SIZE=2>Performance</TD>
<TD BGCOLOR="#003088" VALIGN=TOP>
<FONT COLOR=white SIZE=2>Analyze Stats - Oracle Optimizer needs this.</TD>
</TR>

<TR>
<TD BGCOLOR="#003088"><FONT COLOR=white SIZE=2>Trigger</TD>
<TD BGCOLOR="#003088" VALIGN=TOP>
<A HREF="chk_trigger.htm">
<FONT COLOR=white SIZE=2>Check Trigger Definition</A> - Bypasses limits on LONG fields</FONT></TD>
</TR>

<TR>
<TD BGCOLOR="#003088"><FONT COLOR=white SIZE=2>Users</TD>
<TD BGCOLOR="#003088" VALIGN=TOP>
<A HREF="#CHANGE_USER"><FONT COLOR=white SIZE=2>Change User in SQLPLUS Session.</A></FONT></TD>
</TR>

<TR>
<TD BGCOLOR="#003088"><FONT COLOR=white SIZE=2>Users</TD>
<TD BGCOLOR="#003088" VALIGN=TOP>
<A HREF="#CHECK_USER"><FONT COLOR=white SIZE=2>Check User in SQLPLUS.</A></FONT></TD>
</TR>

</TABLE>

</CENTER>

</TABLE>

<HR>

<A NAME="CHANGE_USER"></A>
<FONT COLOR=red>To change User in SQLPLUS Session ...</FONT>
<LI>rem connect login/password, for example ...
<LI>connect scott/tiger; 
<BR>Then, to check the results ...
<LI>show user;

<BR><BR><FONT COLOR=red>1b. To change Schema to a different User in SQLPLUS Session ...</FONT>
<LI>rem ALTER SESSION SET CURRENT_SCHEMA="USER_ID", for example ...
<LI>ALTER SESSION SET CURRENT_SCHEMA="scott"; 
<BR>Note that the Schema Name must be a vaid User.

<BR><BR><A HREF="#TOP"><IMG BORDER=0 SRC="images/top.gif">Back to the Top</A>

<A NAME="CHECK_DATE"></A>
<HR><FONT COLOR=red>Check the Date and Time in </FONT><FONT COLOR=green>Oracle Report Format...</FONT>
<BR>set linesize 132
<BR>column todays_date format a20 heading 'Todays date'
<BR>select TO_CHAR(SysDate,'DD/Mon/YYYY  HH:MI P.M.') todays_date from dual;


<A NAME="CHECK_USER"></A>
<HR><FONT COLOR=red>To check the User in SQLPLUS Session ...</FONT>
<LI>show user;


<A NAME="GEN_ANALYZE"></A>
<HR><FONT COLOR=red>4a. Generate SQL to Estimate Record Counts ...</FONT>
<PRE>
set feedback off
set heading off
spool analyze_all_tables.sql
rem
SELECT 'ANALYZE TABLE '||' '||Table_name||' ESTIMATE STATISTICS;' 
FROM all_tables
WHERE owner='scott';
spool off
quit
</PRE>

<HR><FONT COLOR=red>4b. Sample Output from the Generated SQL ...</FONT>
<PRE>
spool analyze_stats.op
set echo on;
set feedback off;
set heading off;
ANALYZE TABLE  scott.SUBCONTRACT_DAYS ESTIMATE STATISTICS;                     
ANALYZE TABLE  scott.SUBCONTRACT_NOMINATIONS ESTIMATE STATISTICS;              
ANALYZE TABLE  scott.SUBCONTRACT_OPTIONS ESTIMATE STATISTICS;                  
ANALYZE TABLE  scott.SUBCONTRACT_RAMP_RATES ESTIMATE STATISTICS;               
ANALYZE TABLE  scott.SUBCONTRACT_TARIFFS ESTIMATE STATISTICS;                  
ANALYZE TABLE  scott.SUBCONTRACT_TERMS ESTIMATE STATISTICS;                    
ANALYZE TABLE  scott.SUBTERMINALS ESTIMATE STATISTICS;                         
... ditto ...
</PRE>


<A NAME="GEN_CHECK"></A>
<HR><FONT COLOR=red>To Generate SQL to check values for a specified Field...</FONT>
<LI>After the SQL is generated, use edit/tpu(vi) and Global replace LIKE "LIKE 'SW%' ;"
<PRE>
EMA024::ORACLE $ cat gen_chk_mts_id_data.sql
Rem Filename : gen_chk_mts_id_data.sql
rem Function : Generate SQL to check for Test Data values for a specific fld
rem          : wherever that field,(or something like it) appears.
spool  chk_mts_id_data.sql
set echo off;
rem column min_date format a20 heading 'Min Date' 
set linesize 132;
select name FROM V$DATABASE;
show user;
select TO_CHAR(SysDate,'DD/Mon/YYYY HH:MI P.M.') from dual;
rem
SELECT DISTINCT 'SELECT DISTINCT ' || column_name || ' FROM ' || table_name || 
' WHERE mts_id LIKE ' 
FROM   all_tab_columns 
WHERE  column_name LIKE '%MTS_ID%'
AND    table_name  NOT LIKE 'BARRY%'
AND    table_name  NOT LIKE '%TMP'
AND    table_name  NOT LIKE '%VIEW%'
AND    table_name  NOT LIKE 'Y2K%' ;
rem
spool off;
quit;
</PRE>

<HR><A HREF="#TOP"><IMG BORDER=0 SRC="images/top.gif">Back to the Top</A>


<A NAME="GEN_DELETE"></A>
<HR><FONT COLOR=red>To Generate SQL to delete values for a specified Field...</FONT>
<LI>After the SQL is generated, use edit/tpu(vi) and Global replace LIKE "LIKE 'SW%' ;"
<PRE>

DISK$APPL01:[ORACLE.BARRYS.SCRIPTS.MTRS]GEN_DEL_MTR_DATA.SQL;4
 
Rem Filename : gen_del_mts_id_data.sql
spool  del_mts_id_data.sql
set echo off;
rem column min_date format a20 heading 'Min Date' 
set linesize 132;
select name FROM V$DATABASE;
show user;
select TO_CHAR(SysDate,'DD/Mon/YYYY HH:MI P.M.') from dual;
rem
SELECT DISTINCT 'DELETE FROM ' || table_name || 
' WHERE ' || column_name || ' LIKE '  
FROM   all_tab_columns 
WHERE  column_name LIKE '%MTS_ID%'
AND    table_name  NOT LIKE 'BARRY%'
AND    table_name  NOT LIKE '%TMP'
AND    table_name  NOT LIKE '%VIEW%'
AND    table_name  NOT LIKE 'Y2K%' ;
rem
spool off;
quit;
</PRE>

<HR><A HREF="#TOP"><IMG BORDER=0 SRC="images/top.gif">Back to the Top</A>

<A NAME="WHERE_USED">
<HR><FONT COLOR=red>To Find Tables Where a specific Column is used from System Catalogues...</FONT>
<PRE>
{xxx009}oracle# cat da_utilities/chk_where_used.sql
rem Filename  : chk_where_used.sql
rem Function  : Find Tables where a specified Column is used.
rem Directory : y2k/scott_export_data/mitch/
rem Author    : Barry Williams
rem
rem Step 1) Find the Table Owner ...*/
spool chk_where_used.op
set heading off;
rem SELECT owner,count(*) FROM all_tables GROUP BY owner;
rem
SELECT   DISTINCT  table_name,column_name
FROM     all_tab_columns
WHERE    column_name LIKE '%AGREE%'   
OR       column_name LIKE '%ANN%'   
OR       column_name LIKE '%STOR%'   
OR       table_name  LIKE '%AGREE%'   
OR       table_name  LIKE '%ANN%'  
OR       table_name  LIKE '%STOR%'   
ORDER    BY table_name,column_name;
rem
spool off
quit
{xxx009}oracle# 
</PRE>

<HR><A HREF="#TOP"><IMG BORDER=0 SRC="images/top.gif">Back to the Top</A>

<A NAME="TABLE_DEFS">
<HR><FONT COLOR=red>10. Print Table Definitions, (i.e. Database Definition) ...</FONT>
<PRE>
HOSTNAME::ORACLE $ cat dd_step4b.sql
rem Filename : dd_step4b.sql 
rem Note     : This Version is for IFMS and prints only the
rem          : 'Data' Tables, which begin with FMS_TD_
rem
SELECT name FROM V$DATABASE;
SHOW USER; 
spool dd_step4b.op 
select TO_CHAR(SysDate,'DD/Mon/YYYY HH:MI P.M.') from dual; 
rem
rem set heading off;
rem
set termout  on
set feedback OFF
set verify off
set pagesize 59
set linesize 132
set newpage  0
set space    1
set recsep off
set arraysize 5
rem
rem column COL_COMMENT format a40  word_wrap
column TABLE_NAME  format a30 HEADING   'TABLE NAME'
column KEY_SEQ     format 99  heading  'KEY'
column COLUMN_ID   format 999  heading  'ID'
column COLUMN_NAME format a30  heading  'FIELD NAME'
column TYPE_LENGTH format a15   heading  'DATA TYPE'
rem column CODED_TYPE  format a8   heading  'LENGTH'
rem column DATA_SCALE  format 9    heading  'DEC'                      
column LENGTH      format 9999 heading  'LENGTH'
column NULLABLE    format a5   heading  'NULL?'                 
rem
column TODAY       noprint   new_value   date_var
column USER        noprint   new_value   user_var               
rem
break on TABLE_NAME SKIP 2  
rem
ttitle left 'Date: ' 30th. April 2000 -
center 'IFMS - Tables and Columns  in the FMSPRD1  Database' -
  skip 2
rem  right  'Page ' format 99  SQL.PNO -
rem  skip 2 
rem
rem spool chk_table_defs.op 
rem
SELECT   table_name,key_seq
        ,column_id,column_name
        ,data_type || '(' || TO_CHAR(length) || ')'  type_length
        ,data_scale 
        ,nullable
FROM     barrys_dd2x   
WHERE    table_name LIKE 'FMS_TD_%' 
ORDER BY table_name, key_seq,column_id;
rem
set termout on
rem
spool off;
quit;
HOSTNAME::ORACLE $ 
</PRE>

<BR><BR><A HREF="#TOP"><IMG BORDER=0 SRC="images/top.gif">Back to the Top</A>
<!-- Start of Standard Footer -->
<HR SIZE=3>

<TABLE BORDER=0 WIDTH=80%>
<TR>
<TD ALIGN=middle>
<FONT FACE="Verdana" SIZE=1>        
        [ <A HREF="../index.htm">Home Page</A>
        | <A HREF="../ask_a_question.htm">Ask me a Question</A> 
        | <A HREF="../contact_us.htm">Contact Us</A> 
        | <A HREF="../a_day_in_the_life.htm">The Life of a DBA</A> 
<!---   | <A HREF="mailto:dba@kpisystems.com">Email</A> --->
        | <A HREF="../faqs.htm">FAQs</A> 
        | <A HREF="../search.htm">Search</A>
        | <A HREF="../site_map.htm">Site Map</A> ]
</FONT>
</TD>
</TR>
</TABLE>

<HR SIZE=3>
<!-- End of  Standard Footer -->
<CENTER><FONT SIZE=1><I> &#169  Database Answers Ltd. 2001</I></FONT></CENTER>

</BODY>

</HTML>


