<html>
<head>
<title>e-Commerce Shopping Carts Data Model</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="../../styles/style.css">

<SCRIPT LANGUAGE="JavaScript">
<!--Hide from old browsers


function theDate() {

var days = new Array(8);
days[1] = "Sunday";
days[2] = "Monday";
days[3] = "Tuesday";
days[4] = "Wednesday";
days[5] = "Thursday";
days[6] = "Friday";
days[7] = "Saturday";

var months = new Array(13);
months[1] = "January";
months[2] = "February";
months[3] = "March";
months[4] = "April";
months[5] = "May";
months[6] = "June";
months[7] = "July";
months[8] = "August";
months[9] = "September";
months[10] = "October";
months[11] = "November";
months[12] = "December";

var dateObj = new Date()
var wday = days[dateObj.getDay() + 1]
var lmonth = months[dateObj.getMonth() + 1]
var date = dateObj.getDate()
var fyear = dateObj.getYear()
document.write(wday + " " + lmonth + " " + date + ", " + fyear)
}
		
//-->
</SCRIPT>

</head>

<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">


<TABLE NAME="CHANGE MY WIDTH" WIDTH="90%" border=0 cellspacing=0 cellpadding=0><TR><TD>
<!-- CHANGING THE WIDTH ABOVE WILL CHANGE ALL PAGE WIDTH -->

<table NAME="HEADER" width="100%" border=0 cellspacing="0" cellpadding="0" bgcolor="#FFFFFF">
<tr> 
<td height="68" valign="middle"><img src="../../images/dba_400_home.jpg" width="400" height="58" alt="Database Answers"></td>
<td ALIGN=right HEIGHT=95 ROWSPAN=2 width="100%" valign=middle>
<IMG ALIGN=right ALT="Shopping Cart" HEIiGHT=88 WIiDTH=206 hspace="0" vspace="4" SRC="images/shopping_cart.jpg">  
</td>
</tr>

<TR>
<td width="100%" align="right">
<p class="time"><nobr><SCRIPT LANGUAGE="JavaScript">theDate();</SCRIPT>
<IMG ALT="Printer" SRC="../../images/printer_icon.gif">
<A HREF="e_commerce_shopping_carts_print_version.htm"><FONT COLOR=blue FACE=Verdana SIZE=1>Printer-friendly version</FONT></A>
<nobr></p>
</td>
</TR>
</table>

<table NAME="ORANGE BAND" width="100%" border=0 cellspacing="0" cellpadding="0">
<tr><td height="2"><img src="../images/v3/spacer.gif" width="663" height="2"></td></tr>
<tr><td height="3" bgcolor="#FF9900"><img src="../images/v3/spacer.gif" width="663" height="3"></td></tr>
<tr><td height="2"><img src="../images/v3/spacer.gif" width="663" height="2"></td></tr>
</table>

<table NAME="TOP NAVBAR" width=100% border=0 cellpadding=0 cellspacing=0 background="../../images/v3/px-blue.gif" bgcolor="#3366CC">
<tr>
	<td><img src="../../images/v3/spacer.gif" width=5 height=24></td>
	<td><a href="../../index.htm"><img name="menu_home" src="../../images/v3/menu-home-blue.gif" width=85 height=24 border=0 alt="Home"></a></td>
 	<td><img src="../../images/v3/curve-top-blue.gif" width=28 height=24></td>
	<td><a href="../../ask_a_question.htm"><img name="menu_question" src="../../images/v3/menu-question.gif" width=109 height=24 border=0 alt="Ask a Question"></a></td>
	<td><a href="../../careers.htm"> <img name="menu_careers" src="../../images/v3/menu-careers.gif" width=59 height=24 border=0 alt="Careers"></a></td>
	<td><a href="../../contact_us.htm"><img name="menu_contact" src="../../images/v3/menu-contact.gif" width=76 border=0 height=24 alt="Contact us"></a></td>
	<td><a href="../../data_models/index.htm"><img name="menu_models" src="../../images/v3/menu-models-active.gif" width=83 height=24 border=0 alt="Data Models"></a></td>
	<td><a href="../../first_timers.htm"><img name="menu_timers" src="../../images/v3/menu-timers.gif" width=82 height=24 border=0 alt="First Timers"></a></td>
	<td><a href="../../search.htm"><img name="menu_search" src="../../images/v3/menu-search.gif" width=53 height=24 border=0 alt="Search"></a></td>
	<td width="100%"><a href="../../site_map.htm"><img name="menu_map" src="../../images/v3/menu-map.gif" width=62 height=24 border=0 alt="Site Map"></a></td>
</tr>
</table>

<table NAME="GRAY NAVBAR" width="100%" border=0 cellspacing="0" cellpadding="0">
<tr><td height="2"><img src="../images/v3/spacer.gif" width="663" height="2"></td></tr>
<tr><td height="3" bgcolor="#999999"><img src="../../images/v3/spacer.gif" width="663" height="3"></td></tr>
<tr><td height="2"><img src="../../images/v3/spacer.gif" width="663" height="2"></td></tr>
</table>

<table NAME="MAIN CONTENT" width="100%" border=0 cellspacing="0" cellpadding="0">
<tr> 
<td width="100%" bgcolor="#B0D8FF" valign="top"> 
<img alt="e-Commerce"     src="images/lft_e_commerce.bmp"> 
<img alt="Shopping Carts" src="images/rt_shopping_carts.bmp">  
 
<table width="90%" border=0 cellspacing="0" cellpadding="0">
<tr> 
<td width="21"><img src="../../images/spacer.gif" width="31" height="1"></td>
<td width="100%">
<FONT COLOR=blue FACE=Verdana SIZE=2>
<A HREF="index.htm">Back to the Data Model</A>
<B><BR>The Problem has been defined by Josh as follows :-</B>

<PRE><FONT COLOR=blue FACE=Verdana SIZE=2>A Subject Often overlooked in e-Commerce Databases.
Barry-

I love your site and have reviewed all that it offers.  Unfortunately my problem is still not addressed.

Simple problem with no good solution.  
Basically should one create a shopping cart model / table as well as an order model / table when designing an ecommerce application.

For example, in the real world when a product is selected it is essentially added to your cart.  
When you place the order the items are taken OUT of your cart and and order is created.


To represent this in a db structure you might have:

CART
CART_LINE_ITEM (cart_id, product_id, price, quantity, etc)
ORDER
ORDER_LINE_ITEM


Now my issue with the above is redundancy and duplication of records.  
For example, if a coupon is used then its stored in the cart since you technically have "coupons in your cart." 
 Then when the order is placed it is only logical to "apply that coupon," which means moving the coupon over to 
the order table.  

Worse IMO is that each line item is then literally duplicated from the cart to order line item tables.


Of course, this entire issue can be rectified with this:
CART
LINE_ITEM (cart_id, etc)
ORDER (cart_id)


In that scenario you are basically "buying the cart."  

This seems ok but I have a weird problem with it.  

My issue is that, over time, I will probably want to kill old carts after rolling up the data into a reporting table.  
With this structure that becomes impossible since killing the cart would destroy line items and therefore the order would be incomplete.

Spree, a popular Rails ecommerce Open Source application, handles this differently (which I am currently following).  

They have this:
ORDER
LINE_ITEM

NO cart!  So the minute you add something to your "cart" you are basically creating an order.  
You end up with an ORDER table filled with both placed and abandoned orders.  


I *think* its ok but it just feels "unclean."  
Logically you shouldnt really create an order until, well, you order something.  
Its also weird from a roll-up perspective as I would be "purging" the order table of all abandoned orders over time.  

That scares me.  

I just don't like mass deleting items from an orders table (ugh).


So Im stuck.  

I feel like the best scenario is the first since it separates the cart entirely from the order.  

If I want to delete the carts, no problem, don't touch orders.  

The only issue would be if I store the cart_id with the order so I can reference back.  

Of course if I copy things from cart to order then I really don't need to reference them.


With whatever solution I pick I need to be able to answer these:

<LI>What does my conversion rate look like from visit to cart, visitor to order, cart to order?
<LI>What % of my carts are abandoned?
<LI>What are the conversion rates on a per product basis? 
<LI>What is the abandonment rate per product?

By separating the models its REAL easy to say "give me the total visitors, carts created and orders placed for this time period" and calculate.  

I can also get those with a flag or status column that marks "in process or complete" with the single ORDER (no cart) model.

What do you think?  

You think its better to have a single ORDER table with a "completed?" flag and calculate everything from there 
or should I do the 3 or 4 table solution (or something else?)

Thanks and Happy Holidays!

Josh

<B>B. The Things of Interest, ('THINGS'), include :-</B>
B.1 Items
B.2 Orders
B.3 Products
B.4 Shopping Carts
B.5 Others to be determined.

<B>C. These THINGS are Related as follows :-</B>
C.1 To be determined.

<B>D. Other Characteristics of these THINGS include :-</B>
D.1 To be determined.

<B>E. Sample Data includes :-</B>
E.1 To be determined.

<B>F. Typical Enquiries include :-</B>
F.1 </PRE>
</TD></TR>

<TR>
<TD>&nbsp</TD>
<TD COLSPAN=1><PRE><FONT COLOR=blue FACE=Verdana SIZE=2>Barry Williams
December 27th. 2009
Principal Consultant
Database Answers</PRE>
</td>
</tr>
</table>

</TD>
</TR>
</TABLE>

<table name="GRAY BAND" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td height="2"><img src="../images/v3/spacer.gif" width="663" height="2"></td></tr>
<tr><td height="3" bgcolor="#999999"><img src="../images/v3/spacer.gif" width="663" height="3"></td></tr>
<tr><td height="2"><img src="../images/v3/spacer.gif" width="663" height="2"></td></tr>
</table>

<table NAME="BOTTOM NAVBAR" width=100% border=0 cellpadding=0 cellspacing=0 background="../../images/v3/px-blue.gif" bgcolor="#3366CC">
<tr>
	<td><img src="../../images/v3/spacer.gif" width=5 height=24></td>
	<td><a href="../../index.htm"><img name="menu_home" src="../../images/v3/menu-home-blue.gif" width=85 height=24 border=0 alt="Home"></a></td>
 	<td><img src="../../images/v3/curve-bottom-blue-dark.gif" width=28 height=24></td>
	<td><a href="../../ask_a_question.htm"><img name="menu_question" src="../../images/v3/menu-question.gif" width=109 height=24 border=0 alt="Ask a Question"></a></td>
	<td><a href="../../careers.htm"> <img name="menu_careers" src="../../images/v3/menu-careers.gif" width=59 height=24 border=0 alt="Careers"></a></td>
	<td><a href="../../contact_us.htm"><img name="menu_contact" src="../../images/v3/menu-contact.gif" width=76 border=0 height=24 alt="Contact us"></a></td>
	<td><a href="../../data_models/index.htm"><img name="menu_models" src="../../images/v3/menu-models-active.gif" width=83 height=24 border=0 alt="Data Models"></a></td>
	<td><a href="../../first_timers.htm"><img name="menu_timers" src="../../images/v3/menu-timers.gif" width=82 height=24 border=0 alt="First Timers"></a></td>
	<td><a href="../../search.htm"><img name="menu_search" src="../../images/v3/menu-search.gif" width=53 height=24 border=0 alt="Search"></a></td>
	<td width="100%"><a href="../../site_map.htm"><img name="menu_map" src="../../images/v3/menu-map.gif" width=62 height=24 border=0 alt="Site Map"></a></td>
</tr>
</table>

<table name="ORANGE BAND" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td height="2"><img src="../../images/v3/spacer.gif" width="663" height="2"></td></tr>
<tr><td height="3" bgcolor="#FF9900"><img src="../../images/v3/spacer.gif" width="663" height="3"></td></tr>
</table>

<!-- HERE BASE TABLE CLOSES, INSIDE WHICH ALL PAGE IS PLACED, AND WHICH WIDTH IS 90 PERCENTS --> 
</td>
</tr>
</table>

</body>

</html>
